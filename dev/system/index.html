<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>System · VoronoiFVM.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">VoronoiFVM.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../changes/">Changes</a></li><li><a class="tocitem" href="../method/">The Voronoi finite volume method</a></li><li><span class="tocitem">API Documentation</span><ul><li class="is-active"><a class="tocitem" href>System</a><ul class="internal"><li><a class="tocitem" href="#System-constructors"><span>System constructors</span></a></li><li><a class="tocitem" href="#Adding-species-by-species-numbers"><span>Adding species by species numbers</span></a></li><li><a class="tocitem" href="#Handling-boundary-conditions"><span>Handling boundary conditions</span></a></li><li><a class="tocitem" href="#Various-tools"><span>Various tools</span></a></li><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#Legacy-API"><span>Legacy API</span></a></li></ul></li><li><a class="tocitem" href="../physics/">Physics &amp; special functions</a></li><li><a class="tocitem" href="../solutions/">Solution objects</a></li><li><a class="tocitem" href="../solver/">Solution methods</a></li><li><a class="tocitem" href="../post/">Postprocessing</a></li><li><a class="tocitem" href="../misc/">Miscellaneous</a></li><li><a class="tocitem" href="../quantities/">Quantities</a></li><li><a class="tocitem" href="../allindex/">Index</a></li></ul></li><li><span class="tocitem">Tutorial Notebooks</span><ul><li><a class="tocitem" href="../notebooks/">About the notebooks</a></li><li><a class="tocitem" href="../nbhtml/nonlinear-solvers/">Nonlinear solver control</a></li><li><a class="tocitem" href="../nbhtml/api-update/">0.14.0 API Update</a></li><li><a class="tocitem" href="../nbhtml/flux-reconstruction/">Obtaining vector fields</a></li><li><a class="tocitem" href="../nbhtml/problemcase/">A case for caution</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../runexamples/">About the examples</a></li><li><a class="tocitem" href="../examples/Example101_Laplace1D/">101: 1D Laplace equation</a></li><li><a class="tocitem" href="../examples/Example102_StationaryConvectionDiffusion1D/">102: 1D Stationary convection-diffusion equation</a></li><li><a class="tocitem" href="../examples/Example103_ConvectionDiffusion1D/">103: 1D Convection-diffusion equation</a></li><li><a class="tocitem" href="../examples/Example105_NonlinearPoisson1D/">105: 1D Nonlinear Poisson equation</a></li><li><a class="tocitem" href="../examples/Example106_NonlinearDiffusion1D/">106: 1D Nonlinear Diffusion equation</a></li><li><a class="tocitem" href="../examples/Example107_NonlinearStorage1D/">107: 1D Nonlinear Storage</a></li><li><a class="tocitem" href="../examples/Example110_ReactionDiffusion1D_TwoSpecies/">110: 1D Reaction Diffusion equation with two species</a></li><li><a class="tocitem" href="../examples/Example115_HeterogeneousCatalysis1D/">115: 1D heterogeneous catalysis</a></li><li><a class="tocitem" href="../examples/Example120_ThreeRegions1D/">120: Differing species sets in regions, 1D</a></li><li><a class="tocitem" href="../examples/Example121_PoissonPointCharge1D/">121: 1D Poisson with point charge</a></li><li><a class="tocitem" href="../examples/Example125_TestFunctions1D/">125: Terminal flux calculation via test functions</a></li><li><a class="tocitem" href="../examples/Example150_Impedance1D/">150: Impedance calculation</a></li><li><a class="tocitem" href="../examples/Example151_Impedance1D/">151: Impedance calculation</a></li><li><a class="tocitem" href="../examples/Example160_UnipolarDriftDiffusion1D/">160: Unipolar degenerate drift-diffusion</a></li><li><a class="tocitem" href="../examples/Example201_Laplace2D/">201: 2D Laplace equation</a></li><li><a class="tocitem" href="../examples/Example203_CoordinateSystems/">203: Various coordinate systems</a></li><li><a class="tocitem" href="../examples/Example204_HagenPoiseuille/">204: 2D Convection in Hagen-Poiseuille flow</a></li><li><a class="tocitem" href="../examples/Example205_NonlinearPoisson2D/">205: 2D Nonlinear Poisson equation</a></li><li><a class="tocitem" href="../examples/Example210_NonlinearPoisson2D_Reaction/">210: 2D Nonlinear Poisson with reaction</a></li><li><a class="tocitem" href="../examples/Example215_NonlinearPoisson2D_BoundaryReaction/">215: 2D Nonlinear Poisson with boundary reaction</a></li><li><a class="tocitem" href="../examples/Example220_NonlinearPoisson2D_BoundarySpecies/">220: 2D Nonlinear Poisson with boundary reaction and boundary species</a></li><li><a class="tocitem" href="../examples/Example225_TestFunctions2D/">225: Terminal flux calculation via test functions, nD</a></li><li><a class="tocitem" href="../examples/Example226_BoundaryIntegral/">226: Terminal flux calculation via test functions, nD, boundary reaction</a></li><li><a class="tocitem" href="../examples/Example230_BoundaryFlux/">103: Boundary flux</a></li><li><a class="tocitem" href="../examples/Example301_Laplace3D/">301: 3D Laplace equation</a></li><li><a class="tocitem" href="../examples/Example311_HeatEquation_BoundaryDiffusion/">311: Heat Equation with boundary diffusion</a></li><li><a class="tocitem" href="../examples/Example405_GenericOperator/">405: Generic operator</a></li><li><a class="tocitem" href="../examples/Example406_WeirdReaction/">406: 1D Weird Surface Reaction</a></li><li><a class="tocitem" href="../examples/Example410_ManySpecies/">410: Many Species</a></li><li><a class="tocitem" href="../examples/Example420_DiscontinuousQuantities/">420: Discontinuous Quantities</a></li><li><a class="tocitem" href="../examples/Example421_AbstractQuantities_TestFunctions/">421: Current Calculation for AbstractQuantities</a></li><li><a class="tocitem" href="../examples/Example422_InterfaceQuantities/">422: Drift-Diffusion with Discontinuous and Interface Potentials</a></li><li><a class="tocitem" href="../examples/Example430_ParameterDerivativesStationary/">430: Parameter Derviatives (stationary)</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Documentation</a></li><li class="is-active"><a href>System</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>System</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/j-fu/VoronoiFVM.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="System"><a class="docs-heading-anchor" href="#System">System</a><a id="System-1"></a><a class="docs-heading-anchor-permalink" href="#System" title="Permalink"></a></h1><p>The computational grid required is assumed to correspond to a domain <span>$\Omega=\cup_{r=1}^{n_\Omega} \Omega_r$</span> </p><p>Grids for VoronoiFVM are managed by the packages <a href="https://github.com/j-fu/ExtendableGrids.jl">ExtendableGrids.jl</a> and <a href="https://github.com/j-fu/SimplexGridFactory.jl">SimplexGridFactory.jl</a></p><p>with boundary  <span>$\partial\Omega=\Gamma=\cup_{b=1}^{n_\Gamma} \Gamma_b$</span>.</p><p>The subdomains <span>$\Omega_r$</span> are called &quot;regions&quot; and the boundary subdomains <span>$\Gamma_b$</span> are called &quot;boundary regions&quot;.</p><p>On this complex of domains &quot;lives&quot;  a number of species which are either attached to a number of regions or to a number of boundary regions.</p><p>All these data, the matrix for the linear system and other things are hold together by a struct <code>VoronoiFVM.System</code>.  This type is not exported to avoid name clashes.</p><h2 id="System-constructors"><a class="docs-heading-anchor" href="#System-constructors">System constructors</a><a id="System-constructors-1"></a><a class="docs-heading-anchor-permalink" href="#System-constructors" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.System-Tuple{ExtendableGrid}" href="#VoronoiFVM.System-Tuple{ExtendableGrid}"><code>VoronoiFVM.System</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">System(grid; kwargs...)</code></pre><p>Create structure of type <a href="#VoronoiFVM.System"><code>VoronoiFVM.System{Tv,Ti, Tm, TSpecMat&lt;:AbstractMatrix, TSolArray&lt;:AbstractMatrix}</code></a>  holding data for finite volume system solution. </p><p>Parameters: </p><ul><li><code>grid::ExtendableGrid</code>: 1, 2 or 3D computational grid</li></ul><p>Keyword arguments:</p><ul><li><code>species</code>: vector of integer species indices. Added to all grid regions, avoiding the need to call <a href="#VoronoiFVM.enable_species!-Tuple{VoronoiFVM.AbstractSystem, Integer, AbstractVector}"><code>enable_species!</code></a> for this default case.             If it is kept empty, species have be added to the system after creation via  <a href="#VoronoiFVM.enable_species!-Tuple{VoronoiFVM.AbstractSystem, Integer, AbstractVector}"><code>enable_species!</code></a>.</li><li><code>unknown_storage</code>: string or symbol.     Information  on  species  distribution  is kept  in  sparse  or  dense   matrices matrices and, correspondingly, the  solution array is of type   SparseSolutionArray  or matrix,  respectively. In  the case  of sparse   unknown storage,  the system matrix  handles exactly those  degrees of   freedom which correspond to unknowns.  However, handling of the sparse   matrix  structures  for  the   bookkeeping  of  the  unknowns  creates   overhead.<ul><li><code>:dense</code> :  solution vector is an  <code>nspecies</code> x <code>nnodes</code>  dense matrix</li><li><code>:sparse</code> :  solution vector is an <code>nspecies</code> x <code>nnodes</code>  sparse matrix</li></ul></li><li><code>matrixindextype</code>: Integer type. Index type for sparse matrices created in the system.</li></ul><p>Physics keyword arguments:</p><ul><li><p><code>flux</code>: Function.     Flux between neigboring control volumes: <code>flux(f,u,edge)</code> or <code>flux(f,u,edge,data)</code>   should return in <code>f[i]</code> the flux of species i along the edge joining circumcenters   of neigboring control volumes.  For species i,<code>u[i,1]</code> and <code>u[i,2]</code> contain the unknown values at the corresponding ends of the edge.</p></li><li><p><code>storage</code>: Function.  Storage term (term under time derivative): <code>storage(f,u,node)</code> or <code>storage(f,u,node,data)</code>    It should return in <code>f[i]</code> the storage term for the i-th equation. <code>u[i]</code> contains the value of   the i-th unknown.</p></li><li><p><code>reaction</code>:  Function. Reaction term:  <code>reaction(f,u,node)</code> or <code>reaction(f,u,node,data)</code>    It should return in <code>f[i]</code> the reaction term for the i-th equation. <code>u[i]</code> contains the value of   the i-th unknown.</p></li><li><p><code>source</code>:  Function. Source term: <code>source(f,node)</code> or <code>source(f,node,data)</code>.   It should return the in <code>f[i]</code> the value of the source term for the i-th equation.</p></li><li><p><code>bflux</code>:  Function. Flux between neighboring control volumes on the boundary</p></li><li><p><code>breaction</code> Function.  Boundary reaction term:  <code>breaction(f,u,node)</code> or <code>breaction(f,u,node,data)</code>    Similar to reaction, but restricted to the inner or outer boundaries.</p></li><li><p><code>bcondition</code> Function. Alias for <code>breaction</code>.</p></li><li><p><code>bsource</code>: Function. Boundary source term: <code>bsource(f,node)</code> or <code>bsource(f,node,data)</code>.   It should return in <code>f[i]</code> the value of the source term for the i-th equation.</p></li><li><p><code>bstorage</code>: Function.  Boundary storage term: <code>bstorage(f,u,node)</code> or <code>bstorage(f,u,node,data)</code>    Similar to storage, but restricted to the inner or outer boundaries.</p></li><li><p><code>generic_operator</code>: Funtion.  Generic operator  <code>generic_operator(f,u,sys)</code>.    This operator acts on the full solution <code>u</code> of a system. Sparsity   is detected automatically  unless <code>generic_operator_sparsity</code> is given.</p></li><li><p><code>generic_operator_sparsity</code>:  Function defining the sparsity structure of the generic operator.   This should return the sparsity pattern of the <code>generic_operator</code>.</p></li><li><p><code>nparams</code>: number of parameters the system is depending on, and with respect to which the derivatives   need to be obtained</p></li><li><p><code>data</code>:  User data (parameters).   This allows to pass various parameters to the callback functions. If <code>data</code> is given, all callback functions   should accept a last <code>data</code> argument. Otherwise, no data are passed explicitely, and constitutive callbacks can   take parameters from the closure where the function is defined.</p></li><li><p><code>matrixtype</code>: :default, :sparse, :tridiagonal, :banded</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.System-Tuple{AbstractVector}" href="#VoronoiFVM.System-Tuple{AbstractVector}"><code>VoronoiFVM.System</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">System(X; kwargs...)</code></pre><p>Create an <a href="https://j-fu.github.io/ExtendableGrids.jl/stable/gridconstructors/">1D grid from vector X</a> and call  <a href="#VoronoiFVM.System-Tuple{ExtendableGrid}"><code>VoronoiFVM.System(grid::ExtendableGrid; kwargs...)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.System-Tuple{AbstractVector, AbstractVector}" href="#VoronoiFVM.System-Tuple{AbstractVector, AbstractVector}"><code>VoronoiFVM.System</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">System(X,Y; kwargs...)</code></pre><p>Create a <a href="https://j-fu.github.io/ExtendableGrids.jl/stable/gridconstructors/">2D grid from vectors X,Y </a> and call  <a href="#VoronoiFVM.System-Tuple{ExtendableGrid}"><code>VoronoiFVM.System(grid::ExtendableGrid; kwargs...)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.System-Tuple{AbstractVector, AbstractVector, AbstractVector}" href="#VoronoiFVM.System-Tuple{AbstractVector, AbstractVector, AbstractVector}"><code>VoronoiFVM.System</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">System(X,Y, Z; kwargs...)</code></pre><p>Create a <a href="https://j-fu.github.io/ExtendableGrids.jl/stable/gridconstructors/">3D grid from vectors X,Y,Z </a> and call  <a href="#VoronoiFVM.System-Tuple{ExtendableGrid}"><code>VoronoiFVM.System(grid::ExtendableGrid; kwargs...)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.update_grid!" href="#VoronoiFVM.update_grid!"><code>VoronoiFVM.update_grid!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">update_grid!(system; grid=system.grid)</code></pre><p>Update grid (e.g. after rescaling of coordinates).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><h2 id="Adding-species-by-species-numbers"><a class="docs-heading-anchor" href="#Adding-species-by-species-numbers">Adding species by species numbers</a><a id="Adding-species-by-species-numbers-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-species-by-species-numbers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.enable_species!-Tuple{VoronoiFVM.AbstractSystem, Integer, AbstractVector}" href="#VoronoiFVM.enable_species!-Tuple{VoronoiFVM.AbstractSystem, Integer, AbstractVector}"><code>VoronoiFVM.enable_species!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">enable_species!(system,ispec,regions)</code></pre><p>Add species <code>ispec</code> to a list of bulk regions. Species numbers for bulk and boundary species have to be distinct.  Once a species has been added, it cannot be removed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.enable_species!-Tuple{VoronoiFVM.AbstractSystem}" href="#VoronoiFVM.enable_species!-Tuple{VoronoiFVM.AbstractSystem}"><code>VoronoiFVM.enable_species!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">enable_species!(system; kwargs...)</code></pre><p>Keyword arguments:</p><ul><li><code>species</code>: Integer or vector of integers. Species to be added to the system.</li><li><code>regions</code>: Vector of integers. Regions, where these species shall be added.If <code>nothing</code>, they are added to all species.</li></ul><p>Once a species has been added, it cannot be removed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.enable_boundary_species!" href="#VoronoiFVM.enable_boundary_species!"><code>VoronoiFVM.enable_boundary_species!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">enable_boundary_species!(system,ispec,regions)</code></pre><p>Add species <code>ispec</code> to a list of boundary regions. Species numbers for bulk and boundary species have to be distinct. Once a species has been added, it cannot be removed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><h2 id="Handling-boundary-conditions"><a class="docs-heading-anchor" href="#Handling-boundary-conditions">Handling boundary conditions</a><a id="Handling-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Handling-boundary-conditions" title="Permalink"></a></h2><p>Boundary conditions are handeled in the  <code>bcondition</code> callback passed to the system constructor. For being called in this callback, the following  functions are availabel</p><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.boundary_dirichlet!-NTuple{6, Any}" href="#VoronoiFVM.boundary_dirichlet!-NTuple{6, Any}"><code>VoronoiFVM.boundary_dirichlet!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs"> boundary_dirichlet!(y,u,bnode,ispec,ireg,val)</code></pre><p>Set Dirichlet boundary condition for species ispec at boundary ibc.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.boundary_dirichlet!-Tuple{Any, Any, Any}" href="#VoronoiFVM.boundary_dirichlet!-Tuple{Any, Any, Any}"><code>VoronoiFVM.boundary_dirichlet!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs"> boundary_dirichlet!(y,u,bnode, args...; kwargs...)</code></pre><p>Keyword argument version:</p><ul><li><code>species</code>: species number. Default: 1</li><li><code>region</code>: boundary region number. By default, all boundary regions.</li><li><code>value</code>: value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.boundary_neumann!-NTuple{6, Any}" href="#VoronoiFVM.boundary_neumann!-NTuple{6, Any}"><code>VoronoiFVM.boundary_neumann!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs"> boundary_neumann!(y,u,bnode,ispec,ireg,val)</code></pre><p>Set Neumann boundary condition for species ispec at boundary ibc.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.boundary_neumann!-Tuple{Any, Any, Any}" href="#VoronoiFVM.boundary_neumann!-Tuple{Any, Any, Any}"><code>VoronoiFVM.boundary_neumann!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs"> boundary_neumann!(y,u,bnode, args...; kwargs...)</code></pre><p>Keyword argument version:</p><ul><li><code>species</code>: species number. Default: 1</li><li><code>region</code>: boundary region number. By default, all boundary regions.</li><li><code>value</code>: value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.boundary_robin!-NTuple{7, Any}" href="#VoronoiFVM.boundary_robin!-NTuple{7, Any}"><code>VoronoiFVM.boundary_robin!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs"> boundary_robin!(y,u,bnode,ispec,ireg,fac,val)</code></pre><p>Set Robin boundary condition for species ispec at boundary ibc.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.boundary_robin!-Tuple{Any, Any, Any}" href="#VoronoiFVM.boundary_robin!-Tuple{Any, Any, Any}"><code>VoronoiFVM.boundary_robin!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs"> boundary_robin!(y,u,bnode, args...; kwargs...)</code></pre><p>Keyword argument version:</p><ul><li><code>species</code>: species number. Default: 1</li><li><code>region</code>: boundary region number. By default, all boundary regions.</li><li><code>factor</code>: factor</li><li><code>value</code>: value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.ramp" href="#VoronoiFVM.ramp"><code>VoronoiFVM.ramp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">   ramp(t; kwargs...)</code></pre><p>Ramp function for specifying time dependent boundary conditions</p><p>Keyword arguments:</p><ul><li><code>dt</code>: Tuple: start and end time of ramp. Default: <code>(0,0.1)</code></li><li><code>du</code>: Tuple: values at start and end time. Default: <code>(0,0)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><h2 id="Various-tools"><a class="docs-heading-anchor" href="#Various-tools">Various tools</a><a id="Various-tools-1"></a><a class="docs-heading-anchor-permalink" href="#Various-tools" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.physics!" href="#VoronoiFVM.physics!"><code>VoronoiFVM.physics!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">physics!(system,physics)</code></pre><p>Replace System&#39;s physics data</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section><section><div><p>physics!(system; kwargs...)</p><p>Replace System&#39;s physics data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.check_allocs!" href="#VoronoiFVM.check_allocs!"><code>VoronoiFVM.check_allocs!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">check_allocs!(system,true_or_false)</code></pre><p>Enable/disable checking for time-consuming allocations in the assembly loop.  By default,  this check  is switched off.  By setting  the environment variable <code>ENV[&quot;VORONOIFVM_CHECK_ALLOCS&quot;]=&quot;true&quot;</code>, this  default can be changed.</p><p>Unless  the   matrix  pattern  changes,  there   shouldn&#39;t  occur  any allocations in this loop. The check  method is aware of matrix pattern changes. As a consequence, allocations in the assembly loop are mostly due to type instabilities in physics callbacks, see the the discussion <a href="../runexamples/#Performance-with-closures">here</a>.  Type instabilities can be debugged via the <code>@time</code>  macro applied to expressions in a physics callback.</p><p>The following  cases provide some ideas  where to look for  reasons of the problem and possible remedies:</p><p>Case 1: a parameter changes its value, and Julia is not sure about the type.</p><pre><code class="language-julia hljs">eps=1.0

flux(f,_u,edge)
    u=unkowns(edge,_u)
    f[1]=eps*(u[1,1]-[1,2])
end
... solve etc ...
eps=2.0</code></pre><p>Remedy: use a type annotation <code>eps::Float64=...</code> to signalize your intent to Julia. This behaviour is explained in the <a href="https://docs.julialang.org/en/v1/manual/performance-tips/#man-performance-captured">Julia documentation</a>.</p><p>Case 2: variables in the closure have the same name as a variable introduced in a callback.</p><pre><code class="language-julia hljs">flux(f,_u,edge)
    u=unkowns(edge,_u)
    f[1]=(u[1,1]-[1,2])
end

... create etc ...

u=solve(...)</code></pre><p>Remedy: rename e.g. <code>u=solve()</code> to <code>sol=solve()</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.num_dof" href="#VoronoiFVM.num_dof"><code>VoronoiFVM.num_dof</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">num_dof(system)
</code></pre><p>Number of degrees of freedom for system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.unknowns-Tuple{VoronoiFVM.AbstractSystem}" href="#VoronoiFVM.unknowns-Tuple{VoronoiFVM.AbstractSystem}"><code>VoronoiFVM.unknowns</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">unknowns(sys; inival)
</code></pre><p>Create a solution vector for system. If inival is not specified, the entries of the returned vector are undefined.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section><section><div><pre><code class="language-julia hljs">unknowns(
    edge::VoronoiFVM.AbstractEdge,
    u::AbstractArray{Tv, 1},
    i
) -&gt; VoronoiFVM.VectorUnknowns
</code></pre><p>Construct vector unknowns on edge.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section><section><div><p>Create a vector of unknowns of the impedance system</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.isunknownsof" href="#VoronoiFVM.isunknownsof"><code>VoronoiFVM.isunknownsof</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">isunknownsof(u, sys)
</code></pre><p>Detect if array fits to the system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.reshape" href="#Base.reshape"><code>Base.reshape</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">reshape(v, system)
</code></pre><p>Reshape vector to fit as solution to system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.norm-Tuple{VoronoiFVM.AbstractSystem, Any, Any}" href="#LinearAlgebra.norm-Tuple{VoronoiFVM.AbstractSystem, Any, Any}"><code>LinearAlgebra.norm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">norm(system, u, p)
</code></pre><p>Calculate norm, paying attention to species distribution over regions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.AbstractSystem" href="#VoronoiFVM.AbstractSystem"><code>VoronoiFVM.AbstractSystem</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractSystem{Tv&lt;:Number, Tc&lt;:Number, Ti&lt;:Integer, Tm&lt;:Integer}</code></pre><p>Abstract type for finite volume system structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.System" href="#VoronoiFVM.System"><code>VoronoiFVM.System</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct System{Tv, Tc, Ti, Tm, TSpecMat&lt;:(AbstractMatrix), TSolArray&lt;:(AbstractMatrix)} &lt;: VoronoiFVM.AbstractSystem{Tv, Tc, Ti, Tm}</code></pre><p>Structure holding data for finite volume system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.DenseSystem" href="#VoronoiFVM.DenseSystem"><code>VoronoiFVM.DenseSystem</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">const DenseSystem</code></pre><p>Type alias for system with dense matrix based species management</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.SparseSystem" href="#VoronoiFVM.SparseSystem"><code>VoronoiFVM.SparseSystem</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">const SparseSystem</code></pre><p>Type alias for system with sparse matrix based species management</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><h2 id="Legacy-API"><a class="docs-heading-anchor" href="#Legacy-API">Legacy API</a><a id="Legacy-API-1"></a><a class="docs-heading-anchor-permalink" href="#Legacy-API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.boundary_dirichlet!-Tuple{VoronoiFVM.AbstractSystem, Any, Any, Any}" href="#VoronoiFVM.boundary_dirichlet!-Tuple{VoronoiFVM.AbstractSystem, Any, Any, Any}"><code>VoronoiFVM.boundary_dirichlet!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">boundary_dirichlet!(system, ispec, ibc, v)
</code></pre><p>Set Dirichlet boundary condition for species ispec at boundary ibc:</p><p><span>$u_{ispec}=v$</span> on <span>$\Gamma_{ibc}$</span></p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Starting with version 0.14, it is preferable to define boundary condtitions within the <code>bcondition</code> physics callback</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.boundary_dirichlet!-Tuple{VoronoiFVM.AbstractSystem}" href="#VoronoiFVM.boundary_dirichlet!-Tuple{VoronoiFVM.AbstractSystem}"><code>VoronoiFVM.boundary_dirichlet!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">  boundary_dirichlet!(system; kwargs...)</code></pre><p>Keyword argument version:</p><ul><li><code>species</code>: species number</li><li><code>region</code>: region number</li><li><code>value</code>: value</li></ul><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Starting with version 0.14, it is preferable to define boundary condtions within the <code>bcondition</code> physics callback</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.boundary_neumann!-Tuple{VoronoiFVM.AbstractSystem, Any, Any, Any}" href="#VoronoiFVM.boundary_neumann!-Tuple{VoronoiFVM.AbstractSystem, Any, Any, Any}"><code>VoronoiFVM.boundary_neumann!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">boundary_neumann!(system, ispec, ibc, v)
</code></pre><p>Set Neumann boundary condition for species ispec at boundary ibc:</p><p><span>$\mathrm{flux}_{ispec}\cdot \vec n=v$</span> on <span>$\Gamma_{ibc}$</span></p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Starting with version 0.14, it is preferable to define boundary condtitions within the <code>bcondition</code> physics callback</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.boundary_neumann!-Tuple{VoronoiFVM.AbstractSystem}" href="#VoronoiFVM.boundary_neumann!-Tuple{VoronoiFVM.AbstractSystem}"><code>VoronoiFVM.boundary_neumann!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">  boundary_neumann!(system; kwargs...)</code></pre><p>Keyword argument version:</p><ul><li><code>species</code>: species number</li><li><code>region</code>: region number</li><li><code>value</code>: value</li></ul><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Starting with version 0.14, it is preferable to define boundary condtitions within the <code>bcondition</code> physics callback</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.boundary_robin!-Tuple{VoronoiFVM.AbstractSystem, Any, Any, Any, Any}" href="#VoronoiFVM.boundary_robin!-Tuple{VoronoiFVM.AbstractSystem, Any, Any, Any, Any}"><code>VoronoiFVM.boundary_robin!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">boundary_robin!(system, ispec, ibc, α, v)
</code></pre><p>Set Robin boundary condition for species ispec at boundary ibc:</p><p><span>$\mathrm{flux}_{ispec}\cdot \vec n + \alpha u_{ispec}=v$</span> on <span>$\Gamma_{ibc}$</span></p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Starting with version 0.14, it is preferable to define boundary condtitions within the <code>bcondition</code> physics callback</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VoronoiFVM.boundary_robin!-Tuple{VoronoiFVM.AbstractSystem}" href="#VoronoiFVM.boundary_robin!-Tuple{VoronoiFVM.AbstractSystem}"><code>VoronoiFVM.boundary_robin!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">  boundary_robin!(system; kwargs...)</code></pre><p>Keyword argument version:</p><ul><li><code>species</code>: species number</li><li><code>region</code>: region number</li><li><code>factor</code>: factor</li><li><code>value</code>: value</li></ul><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Starting with version 0.14, it is preferable to define boundary condtitions within the <code>bcondition</code> physics callback</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/j-fu/VoronoiFVM.jl">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../method/">« The Voronoi finite volume method</a><a class="docs-footer-nextpage" href="../physics/">Physics &amp; special functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 13 October 2022 11:23">Thursday 13 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
